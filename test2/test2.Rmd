---
title: "Examen Probabilidad"
output: html_document
---
```{r setup, include=FALSE}
set.seed(123)
```



## PROBLEMA 1

 La probabilidad de que una industria se ubique en Medell´ın es de 0,7; de que se localice en
Bogot´a, de 0,4; y de que se encuentre ya sea en Medell´ın o en Bogot´a, o en ambas, 0,8. ¿cu´al es la probabilidad
de que la industria se localice

```{r problema1}
# P(M) = 0.7, P(B) = 0.4, P(M ∪ B) = 0.8
P_M <- 0.7
P_B <- 0.4
P_union <- 0.8

#Con esta formula
#P(A ∩ B) = P(A) + P(B) - P(A ∪ B)

# 1. P(ambas)
P_ambas <- P_M + P_B - P_union
cat("P(ambas):", P_ambas, "\n")

# 2. P(ninguna)  
P_ninguna <- 1 - P_union
cat("P(ninguna):", P_ninguna, "\n")
```

## PROBLEMA 2


Un dado-octaedro (de ocho caras) tiene el n´umero 1 pintado en tres de sus caras, el 2 en dos
de sus caras, el 3 en una de sus caras y el 4 en dos de sus caras. Se lanza el dado. Suponga que cada cara
tiene la misma probabilidad de salir. Identifique el espacio muestral y realice una simulaci´on de 10, 100 y
1000 lanzamientos del dado y estime:

```{r problema2}
# Dado octaedro: 3 caras con 1, 2 caras con 2, 1 cara con 3, 2 caras con 4
caras <- c(1,1,1,2,2,3,4,4)

# Simulaciones
for(n in c(10, 100, 1000)) {
  lanzamientos <- sample(caras, n, replace = TRUE)
  p_impar <- mean(lanzamientos %% 2 == 1)
  p_2 <- mean(lanzamientos == 2)
  cat("n =", n, "P(impar) =", round(p_impar, 3), "P(2) =", round(p_2, 3), "\n")
}

caras_cargado <- c(1,1,1,2,2,3,4,4,4)
for(n in c(10, 100, 1000)) {
  # Dado cargado (4 tiene doble probabilidad)
  lanz_cargado <- sample(n, 1000, replace = TRUE)
  cat("n =", n,"Dado cargado - P(impar):", round(mean(lanz_cargado %% 2 == 1), 3), "\n")
  cat("n =", n, "Dado cargado - P(2):", round(mean(lanz_cargado == 2), 3), "\n")
}
```

## PROBLEMA 3

Una cadena de tiendas de pintura produce y vende pinturas de l´atex y semiesmaltadas. De
acuerdo con las ventas a largo plazo, la probabilidad de que un cliente compre pintura de l´atex es 0,75. De los
que compran pintura de l´atex, 60 % tambi´en compran rodillos. Sin embargo, solo 30 % de los que compran
pintura semiesmaltada compra rodillos

```{r problema3}
n <- 1000
P_latex <- 0.75
P_rodillo_latex <- 0.60
P_rodillo_semi <- 0.30


# 1. Generar compradores (0=latex, 1=semiesmaltada)
tipo_pintura <- rbinom(n, 1, 1-P_latex) # genera 1000 ensayos Bernoulli

# 2. Generar compradores de rodillos
compra_rodillo <- numeric(n)
for(i in 1:n) {
  if(tipo_pintura[i] == 0) { # Si compra LÁTEX
    compra_rodillo[i] <- rbinom(1, 1, P_rodillo_latex) # 60% probabilidad de comprar rodillo
  } else {
    compra_rodillo[i] <- rbinom(1, 1, P_rodillo_semi) # 30% probabilidad de comprar rodillo
  }
}

cat("Vector Rodillo, Resultados",compra_rodillo)

# Estimaciones
P_rodillo_sim <- mean(compra_rodillo)
P_latex_dado_rodillo_sim <- mean(tipo_pintura[compra_rodillo == 1] == 0)

# Calculos teóricos
P_rodillo_teorica <- P_latex * P_rodillo_latex + (1-P_latex) * P_rodillo_semi
P_latex_dado_rodillo_teorica <- (P_rodillo_latex * P_latex) / P_rodillo_teorica

cat("La probabilidad que un cliente compre el rodillo es:",P_rodillo_teorica)

cat("P(rodillo) - Sim:", round(P_rodillo_sim, 3), "Teórica:", round(P_rodillo_teorica, 3), "\n")

#Use los axiomas y propiedades de probabilidad (teorema de Bayes y probabilidad total) para comparar los resultados obtenidos en la pregunta anterior.

cat("P(latex|rodillo) - Sim:", round(P_latex_dado_rodillo_sim, 3), "Teórica:", round(P_latex_dado_rodillo_teorica, 3), "\n")
```

## PROBLEMA 4

A la sucursal Santa fe a de cierto banco llegan en promedio 36 clientes en una hora pico. Un
cajero puede atender, en promedio 8 clientes en esa hora. 

```{r problema4}
lambda_hora <- 36
lambda_5min <- lambda_hora * 5/60
cajero_hora <- 8

# a.1) P(X ≤ 2) en 5 minutos
p1 <- ppois(2, lambda_5min)
cat("P(≤2 clientes en 5min):", round(p1, 4), "\n")

# a.2) P(3 ≤ Y ≤ 5) para cajero
p2 <- ppois(5, cajero_hora) - ppois(2, cajero_hora)
cat("P(cajero atienda 3-5):", round(p2, 4), "\n")

```